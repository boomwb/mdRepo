系统烧录:

需要将 uboot、linux kernel、.dtb(设备树)和 rootfs 这四个文件烧写到板子
上的 EMMC、NAND 或 QSPI Flash 等其他存储设备上

MfgTool(驱动开发指南P1040)

1连接USB-OTG, 

2将拨码开关拨到“USB”模式

按ctrl C可进入uboot模式

网络开机自启动设置:

```
ifconfig eth0 up
udhcpc -i eth0  //通过路由器分配 IP 地址
ifconfig eth0 192.168.1.251 netmask 255.255.255.0
//设置 IP 地址和子网掩码
route add default gw 192.168.1.1
//添加默认网关

每次开机以后都要自己手动打开网卡，然后手动设置 IP 地址也太麻烦了，有没有开机以后
自动启动网卡并且设置 IP 地址的方法呢？肯定有的，我们将打开网卡，设置网卡 IP 地址的命
令添加到/etc/init.d/rcS 文件中就行了，完成以后的 rcS 文件内容如下所示：
#网络开机自启动设置
ifconfig eth0 up
#udhcpc -i eth0
ifconfig eth0 192.168.1.251 netmask 255.255.255.0
route add default gw 192.168.1.1
```



```
电脑PC:192.168.1.20
虚拟机ubuntu:192.168.1.29
开发板:192.168.1.120

uboot挂载:

setenv ipaddr 192.168.1.120
setenv ethaddr 00:04:9f:04:d2:35
setenv gatewayip 192.168.1.1
setenv netmask 255.255.255.0
setenv serverip 192.168.1.29
saveenv

ping一下虚拟机: 
ping 192.168.1.29

TFTP加载zImage和设备树:
正点原子虚拟机镜像中已经搭建好 TFTP 环境，TFTP 工作目录为~/linux/tftp/。如果想加载
自己的镜像文件，只要将镜像文件和设备树拷贝到此目录下，赋予文件可执行权限即可，bootcmd
中设置对应的文件名.
setenv bootcmd 'tftp 80800000 zImage;tftp 83000000 imx6ull-alientek-emmc.dtb;bootz 80800000 - 83000000'
saveenv

NFS 挂载教程文件系统:
正点原子虚拟机镜像中已经搭建好 NFS 环境，NFS 共享目录为~/linux/nfs/。如果想挂载自
己的文件系统，只要将文件系统拷贝到此目录下， bootargs 中设置对应的路径和文件名。
setenv bootargs 'console=ttymxc0,115200 root=/dev/nfs \
nfsroot=192.168.1.29:/home/alientek/linux/nfs/rootfs,proto=tcp rw \
ip=192.168.1.120:192.168.1.29:192.168.1.1:255.255.255.0::eth0:off'
saveenv

boot
```



# 字符设备驱动

insmod 命令不能解决模块的依赖关系  

rmmod drv.ko

modprobe 命令默认会到/lib/modules/(kernel-version)4.1.15 这个目录中查找相应的驱动模块

modprobe -r drv.ko

modinfo xx.ko 查看模块信息



cat /proc/devices  查看当前系统中的所有设备

驱动加载成功要在/dev下创建一个对应的设备节点文件,应用程序就是通过操作这个设备节点文件来完成对设备的操作.输入如下命令创建/dev/chrdevbase 这个设备节点文件:

`mknode /dev/chrdevbase c 200 0`

创建完成以后就会存在/dev/chrdevbase 这个文件



设备号(dev_t):高 12 位为主设备号，低 20 位为次设备号

字符设备的注册与注销

1、静态分配设备号

register_chrdev

unregister_chrdev

2、动态分配设备号

alloc_chrdev_region

 unregister_chrdev_region

## 外设

led  GPIO1_IO03 



lcd

![image-20240615110311418](https://raw.githubusercontent.com/boomwb/mdRepo/main/img/202406151103411.png)





```


depmod
//第一次加载驱动的时候需要运行此命令
modprobe 8188eu.ko
ifconfig wlan0 up
iwlist wlan0 scan
wpa_supplicant -v
联网测试：
先在/etc创建一个wpa_supplicant.conf
wpa_supplicant.conf
文 件 编 写 好 以 后 再 在 开 发 板 根 文 件 系 统 下 创 建 一 个
“/var/run/wpa_supplicant”目录，wpa_supplicant 工具要用到此目录！命令如下：
mkdir /var/run/wpa_supplicant -p
一切准备好以后就可以使用 wpa_supplicant 工具让 RTL8188 USB WIFI 连接到热点上，输
入如下命令:
wpa_supplicant -D wext -c /etc/wpa_supplicant.conf -i wlan0 &
当 RTL8188 连接到 WIFI 热点上以后会输出“wlan0: CTRL-EVENT-
CONNECTED”字样。接下来就是最后一步了，设置 wlan0 的 IP 地址，这里使用 udhcpc 命令
udhcpc -i wlan0   //从路由器获取 IP 地址
ifconfig wlan0
ping -I 192.   www.baidu.com
```





# c语言

```
#include "stdio.h"

static int read_reg(unsigned char reg, unsigned char *value)
{
    *value = 10;
}

int main(void)
{
    unsigned char buffer[5] = {0}; // 初始化数组元素为 0
    unsigned char val = 0;

    read_reg(0x01, &val);
    buffer[4] = val;

    for (int i = 0; i < 5; i++)
    {
        printf("buffer[%d]=%d ", i, buffer[i]);
    }
    printf("\n");

    return 0;
}


```

typedef指针函数